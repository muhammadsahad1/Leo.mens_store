<%- include('../layouts/user/header.ejs') -%>

<div class="container">
  <section class="mt-0 overflow-hidden vh-100 d-flex justify-content-center align-items-center p-4">
    <div class="col col-md-8 col-lg-6 col-xxl-5">
      <!-- Logo-->
      <a class="navbar-brand fw-bold fs-3 flex-shrink-0 order-0 align-self-center justify-content-center d-flex mx-0 px-0" href="./index.html">
        <div class="d-flex align-items-center">
          <svg class="f-w-7" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 77.53 72.26"><path d="M10.43,54.2h0L0,36.13,10.43,18.06,20.86,0H41.72L10.43,54.2Zm67.1-7.83L73,54.2,68.49,62,45,48.47,31.29,72.26H20.86l-5.22-9L52.15,0H62.58l5.21,9L54.06,32.82,77.53,46.37Z" fill="currentColor" fill-rule="evenodd"/></svg>
        </div>
      </a>
      <!-- / Logo-->
      <div class="shadow-xl p-4 p-lg-5 bg-white forget">
        <h1 class="text-center fs-2 mb-5 fw-bold">Reset Password</h1>
        <p class="text-muted">Please enter your new password and confirm it below.</p>
        <form method="post" action="/reset-password" onsubmit="return validate()">
          <input type="hidden" name="userId" value="<%= userId %>">
          <input type="hidden" name="token" value="<%= token %>">
        
          <div class="form-group">

            <div id="passwordError" class="form-label" style="color: red;"></div>
            <label for="new-password" class="form-label">New Password</label>
            <input type="password" class="form-control" id="new-password" placeholder="New Password" name="password" required>
          </div>
          <div class="form-group">
            <label for="confirm-password" class="form-label">Confirm Password</label>
            <div id="passwordError2" class="form-label" style="color: red;"></div>
            <input type="password" class="form-control" id="confirm-password" placeholder="Confirm Password" name="confirmpassword" required>
          </div>
          <button type="submit" class="btn btn-dark d-block w-100 my-4">Reset Password</button>
        </form>
      </div>
    </div>
  </section>
</div>


<script>
  function validate(){
    let newPassword = document.getElementById('new-password')
    let confirmPassword = document.getElementById('confirm-password')
    let errormess = document.getElementById('passwordError')
    if(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{6,}$/.test(newPassword.value)){
      errormess.textContent = 'Password must be atleast 6 charcaters long and contain at least one uppercase letter one lowercase letter,and one number';
      setTimeout(()=>{
        errormess.textContent = '';
      },3000)
      return false
    }else if(newPassword.value !== confirmPassword.value){
      errormess.textContent = 'new password and cofirm password need to be same ';
      setTimeout(()=>{
        errormess.textContent = '';
      },3000)
      return false
    }else{
      return true
    }
  }
</script>
<%- include('../layouts/user/footer.ejs') -%>